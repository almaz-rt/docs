# Шардирование в {{ GP }}

[_Шардирование_](../../glossary/sharding.md) — это стратегия горизонтального масштабирования кластера {{ GP }}, при которой части каждой таблицы в базе данных размещаются на разных хостах-сегментах. Каждый запрос на запись или чтение в {{ GP }} утилизирует все сегменты кластера.

Если правило дистрибуции при создании таблицы не указано, то дистрибуция происходит либо по полю, которое указано в качестве Primary Key (если оно задано), либо по первому полю таблицы (https://docs.vmware.com/en/VMware-Greenplum/6/greenplum-database/ref_guide-sql_commands-CREATE_TABLE.html).

## Ключ дистрибуции {#distribution-key}

Для оптимизации работы операций `JOIN` с большими таблицами вы можете задать [ключ дистрибуции]({{ gp.docs.vmware }}/7/greenplum-database/ref_guide-sql_commands-CREATE_TABLE.html) явным образом. В таком случае при соединении таблиц по указанным в ключе полям операция будет производиться локально на сегменте, и запрос отработает быстрее.

Для создания таблицы с ключом дистрибуции передайте одно или несколько нужных полей в аргументе `DISTRIBUTED BY`:

```sql
CREATE TABLE tableName
(
    column1 type1,
    column2 type2,
    ...
    columnN typeN
) DISTRIBUTED BY (column1);
```

Неверно выбранный ключ может привести к тому, что большая часть данных будет храниться на одном сегменте — это повлечет за собой снижение производительности кластера или остановку работы сегмента, если на его хосте закончится место. Поэтому не выбирайте в качестве ключа дистрибуции:

* поля с временем и датой;
* поля, в которых может оказаться большое количество одинаковых значений;
* поля с большим количеством значений `NULL`.

{% include [greenplum-trademark](../../_includes/mdb/mgp/trademark.md) %}
